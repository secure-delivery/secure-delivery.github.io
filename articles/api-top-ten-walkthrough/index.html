<!doctype html><html dir=ltr lang=en-gb><html dir=ltr lang=en-us><head><meta charset=utf-8><link rel="shortcut icon" href=https://securedelivery.io/favicon.ico><link href="https://fonts.googleapis.com/css?family=Poppins:300,400,400i,600,700|Open+Sans:300,400,600,700,800,900&display=swap" rel=stylesheet type=text/css><link rel=stylesheet href=/css/bootstrap.css type=text/css><link rel=stylesheet href=/style.css type=text/css><link rel=stylesheet href=/css/dark.css type=text/css><link rel=stylesheet href=/css/swiper.css type=text/css><link rel=stylesheet href=/demos/business/business.css type=text/css><link rel=stylesheet href=/demos/business/css/fonts.css type=text/css><link rel=stylesheet href=/css/font-icons.css type=text/css><link rel=stylesheet href=/css/animate.css type=text/css><link rel=stylesheet href=/css/magnific-popup.css type=text/css><link rel=stylesheet href=/css/et-line.css type=text/css><link rel=stylesheet href=/css/custom.css type=text/css><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/colors.css type=text/css><script async src="https://www.googletagmanager.com/gtag/js?id=G-BCGW8B7J2T"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BCGW8B7J2T")</script><title>OWASP API Top 10 CTF Walk-through - Secure Delivery</title><meta property="og:title" content="OWASP API Top 10 CTF Walk-through"><meta property="og:description" content="I&rsquo;ve been promising this walk-through for a while now (ever since first updating this material to use the awesome vAPI CTF 1.1) and now I&rsquo;ve finally gotten around to it.
Getting started To get started with you&rsquo;ll need to have access to the following tools:  Docker - please ensure that you can use docker-compose; git - please make sure you can git clone public repositories; Postman; and of course ZAP."><meta property="og:type" content="article"><meta property="og:url" content="https://securedelivery.io/articles/api-top-ten-walkthrough/"><meta property="article:section" content="articles"><meta property="article:published_time" content="2022-03-10T14:00:00+01:00"><meta property="article:modified_time" content="2022-03-10T14:00:00+01:00"><meta name=author content="Grant Ongers"><meta name=publish_date property="og:publish_date" content="2022-03-10T14:00:00+01:00"><script>window.pipedriveLeadboosterConfig={base:"leadbooster-chat.pipedrive.com",companyId:7866507,playbookUuid:"74a02c57-03ea-482b-a89b-c49910bdb5eb",version:2},function(){var e=window;e.LeadBooster?console.warn("LeadBooster already exists"):e.LeadBooster={q:[],on:function(e,t){this.q.push({t:"o",n:e,h:t})},trigger:function(e){this.q.push({t:"t",n:e})}}}()</script><script src=https://leadbooster-chat.pipedrive.com/assets/loader.js async></script></head><style>.entry-meta:not(.no-separator) li:first-child::before{content:none}</style><body class=stretched><div id=wrapper class=clearfix><header id=header data-sticky-class=not-dark data-responsive-class=not-dark data-sticky-offset=full data-sticky-offset-negative=80><div id=header-wrap><div class=container><div class=header-row><div id=logo><a href=/ class=standard-logo data-dark-logo=/demos/business/images/logo-dark.png><img src=/demos/business/images/logo2.png alt="Canvas Logo"></a>
<a href=/ class=retina-logo data-dark-logo=/demos/business/images/logo-dark@2x.png><img src=/demos/business/images/logo2@2x.png alt="Canvas Logo"></a></div><div class=header-misc><div id=top-search class=header-misc-icon></div></div><div id=primary-menu-trigger><svg class="svg-trigger" viewBox="0 0 100 100"><path d="m30 33h40c3.722839.0 7.5 3.126468 7.5 8.578427C77.5 47.030386 74.772971 50 70 50H50"/><path d="m30 50h40"/><path d="m70 67H30s-7.5-.802118-7.5-8.365747C22.5 51.070624 30 50 30 50h20"/></svg></div><nav class="primary-menu not-dark"><ul class=menu-container><li class=menu-item><a class=menu-link href=/#><div>Home</div></a></li><li class=menu-item><a class=menu-link href=/training><div>Training</div></a></li><li class=menu-item><a class=menu-link href=/practitioners><div>Our Practitioners</div></a></li><li class=menu-item><a class=menu-link href=/press-releases><div>Press Releases</div></a></li><li class=menu-item><a class=menu-link href=/#contact-us data-scrollto=#contact-us><div>Contact Us</div></a></li></ul></nav><form class=top-search-form action=search.html method=get><input type=text name=q class=form-control placeholder="Type & Hit Enter.." autocomplete=off></form></div></div></div><div class=header-wrap-clone></div></header><section id=content><div class="content-wrap pt-0 bg-light"><div class="container clearfix"><div class="entry-image align-full mb-0"><img src=/images/api.png alt="Blog Single" class=align-wide-full><div class="p-4 bg-white position-relative shadow-sm rounded text-center align-wide-lg" style=transform:translateY(-30%)><div class="entry-title pt-3"><h2>OWASP API Top 10 CTF Walk-through</h2></div><div class="entry-meta mb-0 pb-3"><ul class="justify-content-center m-0"><li><i class=icon-calendar3></i> March 10, 2022</li><li><a href=#><i class=icon-user></i> Grant Ongers</a></li><li><i class=icon-folder-open></i> Security, API, CTF, Walkthrough</li></ul></div></div></div><div class="article single-post mw-sm mx-auto"><div class="entry clearfix"><div class=clear></div><div class=entry-content><p>I&rsquo;ve been promising this walk-through for a while now (ever since first updating this material to use the awesome vAPI CTF 1.1) and now I&rsquo;ve finally gotten around to it.</p><h3 id=getting-started>Getting started</h3><h4 id=to-get-started-with-youll-need-to-have-access-to-the-following-tools>To get started with you&rsquo;ll need to have access to the following tools:</h4><ul><li><a href=https://www.docker.com/get-started>Docker</a> - please ensure that you can use <code>docker-compose</code>;</li><li><a href=https://git-scm.com/downloads>git</a> - please make sure you can <code>git clone</code> <strong><em>public</em></strong> repositories;</li><li><a href=https://www.postman.com/downloads/>Postman</a>; and of course</li><li><a href=https://www.zaproxy.org/download/>ZAP</a>.</li></ul><p>Then there are the bonus tools, and I say bonus because I was unable to make either work on both my new Mac (new Mac silicone FTW), or my Ubuntu machine (I don&rsquo;t use Wayland on my XPS). You only need one of these tools, so pick the one suitable for your OS.</p><ul><li><a href=https://waydro.id/>Waydroid</a>; or</li><li><a href=https://www.bluestacks.com/download.html>Bluestacks</a></li></ul><h4 id=youll-also-need-to-grab-that-deliberately-vulnerable-api>You&rsquo;ll also need to grab that deliberately vulnerable API:</h4><p>We are going to be leveraging Tushar (<a href=https://github.com/roottusk>roottusk</a>) Kulkarni&rsquo;s well put together <a href=https://github.com/roottusk/vapi>vAPI</a> which is a Capture the Flag (CTF) style exercise covering off the <a href=https://owasp.org/>OWASP</a> <a href=https://owasp.org/www-project-api-security/>API Top 10</a>. The project is self-contained, leveraging Docker to provide the full requirements and can be grabbed from:</p><ul><li>his GitHub repository <code>git clone https://github.com/roottusk/vapi.git</code>; or</li><li>the Secure Delivery one <code>git clone https://github.com/secure-delivery/vapi.git</code></li></ul><p>Once your clone has completed you simply need to:</p><pre tabindex=0><code>cd vapi
docker-compose up -d
</code></pre><p>You can test that the API has successfully launched by hitting <code>http://localhost/vapi/</code> to see that a Laravel server is up and running and listening there.</p><h4 id=then-we-want-to-launch-our-testing-applications-postman-and-zap>Then we want to launch our testing applications, Postman and ZAP.</h4><p>In Postman, we want to import the files in the <code>vapi/postman/</code> folder which will provide you with both an <strong>Environment</strong> and the <strong>Collection</strong> of API end-points to get started with.</p><p>When launching ZAP we want to make sure that it&rsquo;s configured to accept external requests. The easiest way is to launch ZAP with the following switches <code>zap.sh -config api.addrs.addr.name=.* -config api.addrs.addr.regex=true</code></p><h4 id=we-then-need-to-ensure-that-traffic-is-properly-proxied-to-our-api-through-zap-when-we-use-postman>We then need to ensure that traffic is properly proxied to our API through ZAP when we use Postman.</h4><p>In Postman you need to check and change a couple of things:</p><ul><li><p>Start by ensuring that you configure a proxy server for Postman to use:
<img src=/images/api-1.png alt="Postman configuration - proxy settings"></p></li><li><p>You should also make sure that on your Environments tab the vAPI_ENV for host is set correctly:
<img src=/images/api-2.png alt="Postman configuration - host settings"></p></li><li><p>You need to also ensure that you have enabled the Environment file for Postman
<img src=/images/api-3.png alt="Postman configuration - environment settings"></p></li></ul><p>In ZAP now you check to ensure a couple of things:</p><ul><li><p>Firstly that it&rsquo;s running as a proxy (ensure that the port number here matches your settings in Postman earlier)
<img src=/images/api-4.png alt="ZAP configuration - proxy settings"></p></li><li><p>That your start-up config came through correctly.
<img src=/images/api-5.png alt="ZAP configuration - startup settings"></p></li><li><p>While we are here let&rsquo;s make ZAP super aggressive when fuzzing. You may want to tweak this if your machine appears to struggle but the higher your number of concurrent scans and the lower your delay is the faster you&rsquo;ll fuzz.
<img src=/images/api-7.png alt="ZAP configuration - fuzzer settings"></p></li><li><p>And then turn off the ZAP HUD. Trust me on this one, if you find ZAP not properly proxying your requests (turning POST requests into GET for example) this is going to be why - there is an open <a href=https://github.com/zaproxy/zaproxy/issues/5592>issue</a> describing the frustrations you&rsquo;ll feel here.
<img src=/images/api-6.png alt="ZAP configuration - HUD settings"></p></li></ul><h3 id=owasp-api-top-10>OWASP API Top 10</h3><p>Whew, still here? Excellent. Now let&rsquo;s get to hacking. Starting with&mldr;</p><h4 id=1-broken-object-level-authorization>#1 Broken Object Level Authorization</h4><p>Authorization is about <strong><em>access control</em></strong>, or <strong>what actions</strong> are permitted against <strong>which objects</strong>. The short version of this vulnerability is that a particular object (chunk of data) is not protected the way it should be. There are many reasons this can happen and why it&rsquo;s more likely potentially to happen in APIs rather than standard web applications&mldr; all reasons that we go into when running through these as an exercise, but we&rsquo;re just here for the hacks right now.</p><p>The exercise is a simple one:</p><ul><li><p>Use the <code>POST</code> request to create a new user (populating it with data first)
<img src=/images/api-8.png alt="Postman - API1 - POST User creation"></p></li><li><p>Use the <code>GET</code> request to get that user&rsquo;s details. Notice that the request uses a variable <code>{{api1_id}}</code> for the endpoint whose details we are collecting. That variable was populated with a response value from the <code>POST</code> above&mldr;
<img src=/images/api-9.png alt="Postman - API1 - GET User details"></p></li><li><p>What happens if we manually manipulate that value? In ZAP we can simply grab the <code>GET</code> request from earlier and use the Manual Request Editor to modify the value (to 1 in this example). And as you can see we get our first flag!
<img src=/images/api-10.png alt="ZAP - API1 - Manual Request Editor - Request">
<img src=/images/api-11.png alt="ZAP - API1 - Manual Request Editor - Response"></p></li><li><p>I use ZAP for this and not Postman because even though it&rsquo;s just as easy to modify that endpoint in Postman I want to also show you that authentication IS required and that&rsquo;s easy to quickly do in ZAP.
<img src=/images/api-12.png alt="ZAP - API1 - Manual Request Editor - Invalid Request">
<img src=/images/api-13.png alt="ZAP - API1 - Manual Request Editor - Invalid Response">
<img src=/images/api-14.png alt="ZAP - API1 - Manual Request Editor - NoAuth Request">
<img src=/images/api-15.png alt="ZAP - API1 - Manual Request Editor - NoAuth Response"></p></li><li><p>The <code>PUT</code> request (for updating the account details) can also be used to show that there is some auth happening, and not all actions are affected by the issue.
<img src=/images/api-16.png alt="ZAP - API1 - Manual Request Editor - PUT Request">
<img src=/images/api-17.png alt="ZAP - API1 - Manual Request Editor - PUT Response"></p></li></ul><h4 id=2-broken-user-authentication>#2 Broken User Authentication</h4><p>Where #1 was all about access control, authentication (or AuthC as it&rsquo;s called), is all about identity. While this is a problem in most disciplines there are a lot of reasons that it ranks so highly in the API world, starting with the fact that most identity measures involve a secret that has a tendency to end up in your repository&mldr;</p><p>But let&rsquo;s get into the exercise:</p><ul><li><p>Use the <code>POST</code> request with some random details filled in to try to log into the system.
<img src=/images/api-18.png alt="Postman - API2 - POST User login"></p></li><li><p>The eagle-eyed might have noticed a folder called <code>vapi/Resources/API2_CredentialStuffing</code> when loading the <code>vapi/postman/</code> files. If you take a closer look at that folder you&rsquo;ll discover that those secrets are indeed out there.</p></li><li><p>Switch to ZAP and take a look at the request you just sent. We are going to use ZAP&rsquo;s Fuzzer now along with that credentials list to try see if any users in that breach are users of this system, and (if they are), to see whether they&rsquo;ve reused their passwords&mldr;</p></li><li><p>Select the POST request, high-light the login details, right-click and select <strong>Fuzz</strong>
<img src=/images/api-19.png alt="ZAP - API2 - Fuzzing 1"></p></li><li><p>Click on <strong>Payloads</strong>, then <strong>Add</strong> and paste in the quick and dirty modified version of the <code>creds.csv</code> file that I&rsquo;ve included <a href=../resources/creds.csv>here</a> (using some rough concatenation to make ZAP&rsquo;s job easier)
<img src=/images/api-20.png alt="ZAP - API2 - Fuzzing 2"></p></li><li><p>Hit <strong>Add</strong> again then <strong>OK</strong> and finally <strong>Start Fuzzer</strong>. The Fuzzer will run for a while (depending on how many resources you&rsquo;ve got available to the API and to ZAP) and then boom:
<img src=/images/api-21.png alt="ZAP - API2 - Fuzzing 3"></p></li><li><p>All that&rsquo;s left to do is to use one of those valid Authorization-Tokens on the <code>GET</code> request to find your second flag
<img src=/images/api-22.png alt="ZAP - API2 - Fuzzed Token">
<img src=/images/api-23.png alt="ZAP - API2 - Manual Request Editor - Request">
<img src=/images/api-24.png alt="ZAP - API2 - Manual Request Editor - Response"></p></li></ul><h4 id=3-excessive-data-exposure>#3 Excessive Data Exposure</h4><p>Again, this is an issue in many technologies but because of what APIs are intended for there is a particular concern around this here. It starts with the fact that APIs are usually fronted by an application for users, and that application generally does something to present the data back to the user. It also has to do with the fact that APIs try to be self-describing and so mau provide mote meta-data than they perhaps should.</p><p>Exercise 3 is the one where you&rsquo;ll need to break out the Android virtualisation platform (should you have one working). Don&rsquo;t worry too much if you don&rsquo;t, I have screenshots, and you&rsquo;ll be able to follow along just fine.</p><ul><li><p>If you&rsquo;re able to run <code>vapi/Resources/API3_APK/TheCommentApp.apk</code> then do that, pointing the app at your instance of vAPI (through ZAP as your proxy), creating an account and then logging in and posting a comment.
<img src=/images/api-25.png alt="APK - API3 - Configure">
<img src=/images/api-26.png alt="APK - API3 - Login">
<img src=/images/api-27.png alt="APK - API3 - Post comment"></p></li><li><p>Alternatively you can use Postman to do the same things
<img src=/images/api-28.png alt="Postman - API3 - Create user">
<img src=/images/api-29.png alt="Postman - API3 - Login">
<img src=/images/api-30.png alt="Postman - API3 - Get Comment"></p></li></ul><p>BANG! Flag number three in the bag.</p><p>We really need to have a word with those developers. Not only are they providing data back to the API that the GUI never users (or needs) they are also collecting information (probably for marketing) that we don&rsquo;t need and should never have!</p><h4 id=4-lack-of-resources--rate-limiting>#4 Lack of Resources & Rate Limiting</h4><p>This is an interesting one, mostly because APIs are designed for computers and because computers work faster, and so request and process quicker than humans do.</p><p>We&rsquo;ve already done an exercise that shows this (remember the credential stuffing?) but this is another good opportunity to try out some more ZAP fuzzing:</p><ul><li><p>Use Postman to initiate a mobile login, putting the API into a state that expects a PIN to be entered next.
<img src=/images/api-31.png alt="Postman - API4 - Mobile Login"></p></li><li><p>Attempt a login with any random PIN.
<img src=/images/api-32.png alt="Postman - API4 - PIN attempt"></p></li><li><p>Switch to ZAP and select the OTP POST request, high-light the PIN, right-click and select <strong>Fuzz</strong>.
<img src=/images/api-33.png alt="ZAP - API4 - Fuzzing 1"></p></li><li><p>Click on <strong>Payloads</strong>, then <strong>Add</strong> and change the dropdown to <strong>Numberz</strong>. Set the starting number to <strong><em>1000</em></strong> and the ending one to <strong><em>9999</em></strong>.
<img src=/images/api-34.png alt="ZAP - API4 - Fuzzing 2"></p></li><li><p>Hit <strong>Add</strong> again then <strong>OK</strong> and finally <strong>Start Fuzzer</strong>. The Fuzzer will run for a little longer this time until eventually it spits out the right PIN. You can hit the stop button to the right of the fuzzer&rsquo;s name to stop it once it&rsquo;s done so.
<img src=/images/api-35.png alt="ZAP - API4 - Fuzzing 4"></p></li><li><p>All that&rsquo;s left to do is to log in with the correct PIN, then hit the <code>GET</code> request for the details and your fourth flag
<img src=/images/api-36.png alt="Postman - API4 - PIN attempt 2">
<img src=/images/api-37.png alt="Postman - API4 - GET Details"></p></li></ul><h4 id=5-broken-function-level-authorization>#5 Broken Function Level Authorization</h4><p>We talked about Broken <strong>Object</strong> Level Authorization in #1, and this is much the same type of problem but then not on the data level but rather on the action level. The easiest way to think about this is some level of privileged access accidentally being available to ordinary users.</p><p>The exercise gives us a chance to try some ZAP addons:</p><ul><li><p>Addons for ZAP can be installed like this straight from within ZAP itself. For this exercise you&rsquo;ll want to install <strong>FuzzDB Files</strong>.
<img src=/images/api-38.png alt="ZAP - API5 - Addon Install"></p></li><li><p>In Postman you&rsquo;ll want to fire off the create user <code>POST</code> request.
<img src=/images/api-39.png alt="Postman - API5 - Create user"></p></li><li><p>We&rsquo;ll follow up with the <code>GET</code> user request
<img src=/images/api-40.png alt="Postman - API5 - Get user"></p></li><li><p>Back in ZAP we&rsquo;re going to attack that <code>GET</code> request and see if there are any more privileged endpoints we can fuzz. Select the <code>GET</code> request, high-light the endpoint, right-click and select <strong>Fuzz</strong>
<img src=/images/api-41.png alt="ZAP - API5 - Fuzzing 1"></p></li><li><p>Click on <strong>Payloads</strong>, then <strong>Add</strong>. This time we are going to change the selection to File Fuzzers, and we&rsquo;re going to select the <strong>fuzzdb</strong> -> <strong>discovery</strong> -> <strong>common-methods</strong>
<img src=/images/api-42.png alt="ZAP - API5 - Fuzzing 2"></p></li><li><p>Hit <strong>Add</strong> again then <strong>OK</strong> and finally <strong>Start Fuzzer</strong>. The Fuzzer will run a bit before hitting <code>users</code> and our fifth flag.
<img src=/images/api-43.png alt="ZAP - API5 - Fuzzing 3"></p></li></ul><h4 id=6-mass-assignment>#6 Mass Assignment</h4><p>Mass assignment requires a little explanation for most folks who&rsquo;ve never run across it before - so pretty much anyone who isn&rsquo;t an object orientated programmer.</p><p>Essentially this vulnerability relies on the fact that classes of objects may have special or restricted attributes on them that should only be modified through restricted methods but the implementation on a less restricted method might allow it to update those - even though the API might not advertise the fact.</p><p>Let&rsquo;s take a look in practice:</p><ul><li><p>In Postman use the <code>POST</code> API to create a user.
<img src=/images/api-44.png alt="Postman - API6 - Create user"></p></li><li><p>Now <code>GET</code> that user&rsquo;s details and see that the <code>GET</code> response contains more data in it than the <code>POST</code> did.
<img src=/images/api-45.png alt="Postman - API6 - Get user"></p></li><li><p>Can we use that? Let&rsquo;s use Postman to modify our <code>POST</code> for user creation like this.
<img src=/images/api-46.png alt="Postman - API6 - Create user 2"></p></li><li><p>And then <code>GET</code> that same user back again.
<img src=/images/api-47.png alt="Postman - API6 - Get user 2"></p></li></ul><h4 id=7-security-misconfiguration>#7 Security Misconfiguration</h4><p>This is a big one, and a bit of a catch-all if I&rsquo;m being honest. There are many aspects of configuration that can end up leading to less secure setups. Fortunately ZAP is brilliant at helping us to identify those.</p><p>The exercise we&rsquo;re going to run here is simply hitting the endpoints provided with Postman initially.</p><ul><li><p>Create a user with the <code>POST</code> method.
<img src=/images/api-48.png alt="Postman - API7 - Create user"></p></li><li><p>Log the user in with the provided <code>GET</code> request.
<img src=/images/api-49.png alt="Postman - API7 - Login user"></p></li><li><p>Leverage the <code>GET</code> key request.
<img src=/images/api-50.png alt="Postman - API7 - Get key"></p></li><li><p>Switch over to ZAP and that a look at the <strong>Alerts</strong> tab.
<img src=/images/api-51.png alt="ZAP - API7 - Alerts tab"></p></li></ul><p>So there&rsquo;s a CORS vulnerability we might be able to exploit, possibly with some JAVAScript and a page hosted elsewhere&mldr; and the first time I did this CTF I actually did just that. The problem is that MOST browsers are very careful about CORS now&mldr; API clients need not be so well-behaved.</p><ul><li>Simply modifying the <code>GET</code> key request to include an Origin header from somewhere else&mldr; our seventh flag!
<img src=/images/api-52.png alt="ZAP - API7 - Manual Request Editor - Request">
<img src=/images/api-53.png alt="ZAP - API7 - Manual Request Editor - Response"></li></ul><h4 id=8-injection>#8 Injection</h4><p>Just like web applications, APIs can experience injection attacks in their various forms.</p><p>This exercise is a basic SQL Injection attack and a great opportunity to flex our ZAP skills again.</p><ul><li><p>Using Postman and the <code>POST</code> endpoint attempt to log in.
<img src=/images/api-54.png alt="Postman - API8 - User login attempt"></p></li><li><p>Switch to ZAP and select the login POST request, high-light the password, right-click and select <strong>Fuzz</strong>.
<img src=/images/api-55.png alt="ZAP - API8 - Fuzzing 1"></p></li><li><p>Hit the Edit button and blank out the username value, hit Save afterwards.
<img src=/images/api-56.png alt="ZAP - API8 - Fuzzing 2"></p></li><li><p>Click on <strong>Payloads</strong>, then <strong>Add</strong> and change the dropdown to <strong>File Fuzzers</strong>. Select <strong>fuzzdb</strong> -> <strong>attack</strong> -> <strong>sql-injection</strong> -> <strong>exploit</strong> -> <strong>mysql-injection-login-bypass.txt</strong>.
<img src=/images/api-57.png alt="ZAP - API8 - Fuzzing 3"></p></li><li><p>Hit <strong>Add</strong> again then <strong>OK</strong> and finally <strong>Start Fuzzer</strong>. The Fuzzer will run for a little longer this time until eventually it spits out the right PIN. You can hit the stop button to the right of the fuzzer&rsquo;s name to stop it once it&rsquo;s done so.
<img src=/images/api-58.png alt="ZAP - API8 - Fuzzing 4"></p></li><li><p>All that&rsquo;s left to do is to re-run the <code>GET</code> Secret with the authkey acquired above for flag number 8!
<img src=/images/api-59.png alt="Postman - API8 - Get secret"></p></li></ul><p>If you are having trouble with your FuzzDB files, you may need to ensure that there is a space after the dashes in your SQLi <code>' or 1=1--</code> (sometimes it does seem to get swallowed.)</p><h4 id=9-improper-assets-management>#9 Improper Assets Management</h4><p>This is another brilliant catch-all issue, covering a multitude of API security concerns from incomplete separation of environments through to not properly maintaining legacy endpoints.</p><p>This exercise starts us off with a V2 API, so it&rsquo;s fairly clear what we&rsquo;re aiming for.</p><ul><li><p>Use the <code>POST</code> request to attempt a login.
<img src=/images/api-60.png alt="Postman - API9 - Login"></p></li><li><p>Hrmmm 200 OK? but I&rsquo;ll bet that <code>****</code> is not actually the PIN.</p></li><li><p>In ZAP let&rsquo;s break out our <strong>Numberz</strong> fuzzer again. Select the PIN POST request, high-light the PIN, right-click and select <strong>Fuzz</strong>.
<img src=/images/api-61.png alt="ZAP - API9 - Fuzzing 1"></p></li><li><p>Click on <strong>Payloads</strong>, then <strong>Add</strong> and change the dropdown to <strong>Numberz</strong>. Set the starting number to <strong><em>1000</em></strong> and the ending one to <strong><em>9999</em></strong>.
<img src=/images/api-62.png alt="ZAP - API9 - Fuzzing 2"></p></li><li><p>Hit <strong>Add</strong> again then <strong>OK</strong> and finally <strong>Start Fuzzer</strong>. The Fuzzer will run for six attempts and then the API will start returning 500 errors.
<img src=/images/api-63.png alt="ZAP - API9 - Fuzzing 3"></p></li><li><p>Damn, that means rate limiting is in place! So how do we get around that? Let&rsquo;s start by seeing if there is still a V1 API endpoint around.
<img src=/images/api-64.png alt="ZAP - API9 - Fuzzing 4"></p></li><li><p>Aha! Now let&rsquo;s try that fuzzer again on the newly uncovered endpoint.
<img src=/images/api-65.png alt="ZAP - API9 - Fuzzing 5"></p></li><li><p>Nothing but 200 OK! Excellent no rate-limiting in sight. Finding the correct PIN is a little more tricky however as they are all 200 OK now&mldr; if you sort by the <strong>Size Resp. Body</strong> column you&rsquo;ll see one actually returns more than just a <code>1</code>.
<img src=/images/api-66.png alt="ZAP - API9 - Fuzzing 6"></p></li><li><p>And the response gives you your ninth flag!
<img src=/images/api-67.png alt="ZAP - API9 - Fuzzing 7"></p></li></ul><h4 id=10-insufficient-logging--monitoring>#10 Insufficient Logging & Monitoring</h4><p>Without the right (sufficient and concise enough) logging there is no way to monitor, so these two are one issue. There is actually an OWASP project dedicated to benchmarking log files (<a href=https://owasp.org/www-project-secure-logging-benchmark/>OWASP Secure Logging Benchmark</a>) because of how important this is, especially for APIs.</p><p>The exercise is a very simple one as there simply are no useful logs being kept:</p><ul><li>In Postman simply <code>GET</code> the flag. It&rsquo;s been a lot of work to get here, this last one is free!
<img src=/images/api-68.png alt="Postman - API10 - Get flag"></li></ul><h3 id=wrapping-it-up>Wrapping it up</h3><p>If you enjoyed this walk-through and would like to know more about how we use tools like this CTF to teach development teams how to properly secure and automatically test their APIs please do reach out to us.</p><div class=clear></div><div class="si-share border-0 d-flex justify-content-between align-items-center"><span>Share this Post:</span><div><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fsecuredelivery.io%2farticles%2fapi-top-ten-walkthrough%2f" class="social-icon si-borderless si-linkedin"><i class=icon-linkedin></i>
<i class=icon-linkedin></i></a>
<a href="https://twitter.com/intent/tweet?url=https%3a%2f%2fsecuredelivery.io%2farticles%2fapi-top-ten-walkthrough%2f&text=OWASP%20API%20Top%2010%20CTF%20Walk-through" class="social-icon si-borderless si-twitter"><i class=icon-twitter></i>
<i class=icon-twitter></i></a>
<a href="mailto:?subject=OWASP%20API%20Top%2010%20CTF%20Walk-through&body=https%3a%2f%2fsecuredelivery.io%2farticles%2fapi-top-ten-walkthrough%2f" class="social-icon si-borderless si-email3"><i class=icon-email3></i>
<i class=icon-email3></i></a></div></div></div></div></div></div></div></section><div class="section parallax topmargin-lg mb-0 border-top-0 clearfix" style=background-image:url(/demos/business/images/sections/2.jpg);background-size:cover data-bottom-top="background-position:0px 300px;" data-top-bottom="background-position:0px -300px;"><div class="container clearfix"><div class="row col-mb-50 cleafix"><div class="col-md-6 dark" style=padding-left:60px><div class="heading-block bottommargin-sm border-0"><h3 class=nott style=font-size:46px;font-weight:700;letter-spacing:-2px;line-height:58px>Some feedback from our clients.</h3></div><p>People are at the centre of product security. Our approach means we work directly with the people making decisions, building and infuencing product development.</p><p>We love to work with these teams and we love to hear from them as to how they've found working with us. Here are some examples of the feedback we get from teams across our clients' organisations.</p></div><div class="col-md-5 offset-md-1"><h4 class=dark>&nbsp;</h4><div class="fslider testimonial" data-animation=slide data-arrows=false><div class=flexslider><div class=slider-wrap><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">I like how you tied back Security to the four metrics metrics in Accelerate as well as SRE principles, that was very clear. I was actually already planning to recommend you to some people in my network :)</p><div class=testi-meta>SRE
<span>Energy Sector</span><div class=testimonials-rating>Engineering Foundations Course</div></div></div></div></div><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">[Practioner] clearly has a wealth of expertise in application security, and uses this very effectively to provide a highly informative course that includes insights and recommendations specific to our business domain. I am confident that other business domains would be equally served due to [Practitioner]'s range of experience.</p><div class=testi-meta>Engineering
<span>Medical Equipment & Devices Sector</span><div class=testimonials-rating>Decision Makers Foundations Course</div></div></div></div></div><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">The hands on sessions of seeing an issue and then fixing it in the code really brought it to life. Letting us do the fixing rather than watching keeps you involved, I thought the site was excellent</p><div class=testi-meta>Engineering
<span>Retail Sector</span><div class=testimonials-rating>Secure Coding Workshop</div></div></div></div></div><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">[Practitioner]'s knowledge and experience is exceptional. I really liked the Case Studies. I could always use more.</p><div class=testi-meta>IT Management
<span>Medical Equipment & Devices Sector</span><div class=testimonials-rating>Decision-Makers Foundations Course</div></div></div></div></div><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">Good to refresh and increase knowledge, labs were enjoyable and illustrated the points well.</p><div class=testi-meta>Engineering
<span>Energy Sector</span><div class=testimonials-rating>Secure Coding Workshop</div></div></div></div></div><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">[Practioner] was engaging, knowledgable and great to listen to and work with</p><div class=testi-meta>Engineering
<span>Retail Sector</span><div class=testimonials-rating>Engineering Foundations Course</div></div></div></div></div><div class=slide><div class="testimonial border-0 shadow-none"><div class=testi-content><p class="bottommargin-sm font-primary">Great news, the amazing [Practitioner] from Secure Delivery has agreed to deliver security training again this year!</p><div class=testi-meta>Tech Leadership
<span>Energy Sector</span><div class=testimonials-rating>Engineering Foundations Course</div></div></div></div></div></div></div></div></div></div></div></div><div id=contact-us class="section bg-transparent pb-0 mb-0"><div class=container><div class=row><div class="col-lg-5 order-lg-12"><div class="device-xl device-md topmargin-lg"></div><h3 class=mb-0 style=font-size:38px>Security is part of delivery</h3><h3 class="fw-light ls4 text-lowercase" style=font-size:15px;color:#999>and we'll help make it happen</h3><p>If you'd like to find out more about securing and raising the quality of your digital product delivery to stand out from the competition then get in touch with us. We'd love to have a chat about our proven approach and see how we can best help your organisation succeed.</p></div><div class="col-lg-7 order-lg-1"><div style=position:relative;margin-bottom:0 class=overflow-hidden data-height-xl=520 data-height-lg=520 data-height-md=520 data-height-sm=500 data-height-xs=500><div class=pipedriveWebForms data-pd-webforms=https://webforms.pipedrive.com/f/1sUKi1bzhH8kmFCMnZFoWAcftAMp9HYHqLdbLAaHwW9OIbqumrZEkLCJJ2pamBW9B><script src=https://webforms.pipedrive.com/f/loader></script></div></div></div></div></div></div><div class="section m-0 clearfix" style="padding:80px 0"><div id=oc-clients-full class="owl-carousel owl-carousel-full image-carousel carousel-widget" data-margin=0 data-nav=false data-pagi=false data-loop=true data-autoplay=3000 data-items-xs=2 data-items-sm=3 data-items-md=5 data-items-lg=5 data-items-xl=5><div class=oc-item><a href=#><img src=/demos/business/images/clients/newmotion.svg style=height:24px alt="Shell NewMotion Logo"></a></div><div class=oc-item><a href=#><img src=/demos/business/images/clients/frasersgroup.svg style=height:24px alt="Frasers Group Logo"></a></div><div class=oc-item><a href=#><img src=/demos/business/images/clients/hmrc.svg style=height:24px alt="HMRC Logo"></a></div><div class=oc-item><a href=#><img src=/demos/business/images/clients/ef.svg style=height:24px alt="EF Logo"></a></div><div class=oc-item><a href=#><img src=/demos/business/images/clients/jlp.svg style=height:24px alt="John Lewis & Partners Logo"></a></div><div class=oc-item><a href=#><img src=/demos/business/images/clients/waters.svg style=height:24px alt="Waters Logo"></a></div><div class=oc-item><a href=#><img src=/demos/business/images/clients/lego.svg style=height:24px alt="Lego Logo"></a></div></div></div><footer id=footer class=border-0 style="padding:30px 0;background-color:#fff"><div class="container clearfix"><div class=footer-widgets-wrap><div class=row><div class="col-md-4 d-flex justify-content-center align-items-start"><img src=/demos/business/images/logo@2x.png alt="Secure Delivery Logo"></div><div class=col-md-8><div class="row col-mb-30"><div class="col-sm-12 col-lg-12"><div class="widget widget_links widget-li-noicon clearfix"><h4>Links</h4><ul><li><a href=/modern-slavery-and-human-trafficking-policy-statement/>Modern Slavery and Human Trafficking Policy Statement</a></li><li><a href=/privacy-policy/>Privacy Policy</a></li></ul></div></div></div><div class="line line-sm"></div><div class="row justify-content-between col-mb-30"><div class="col-12 col-md-auto text-center text-md-start"><small class=fw-light>Secure Delivery is a limited company registered in England and Wales. Registered number: 12465389. Registered office: Office 7, 35/37 Ludgate Hill, London, EC4M 7JN.</small></div><div class="col-12 col-md-auto text-center text-md-start"><small class=fw-light style=color:#aaa>Copyrights &copy; 2020-2022 All Rights Reserved by Secure Delivery ltd.</small></div><div class="col-12 col-md-auto text-center text-md-end"><a href=https://linkedin.com/company/securedelivery class="social-icon inline-block si-mini si-rounded si-colored si-facebook"><i class=icon-linkedin></i>
<i class=icon-linkedin></i></a>
<a href=https://twitter.com/securedelivery class="social-icon inline-block si-mini si-rounded si-colored si-twitter"><i class=icon-twitter></i>
<i class=icon-twitter></i></a>
<a href=https://github.com/secure-delivery class="social-icon inline-block si-mini si-rounded si-colored si-gplus"><i class=icon-github></i>
<i class=icon-github></i></a>
<a href=https://www.youtube.com/channel/UCLp7d3xPdMtGNafaStWeOpg class="social-icon inline-block si-mini si-rounded si-colored si-pinterest"><i class=icon-youtube></i>
<i class=icon-youtube></i></a>
<a href=https://instagram.com/securedelivery.io class="social-icon inline-block si-mini si-rounded si-colored si-instagram"><i class=icon-instagram></i>
<i class=icon-instagram></i></a></div></div></div></div></div></div></footer></div><script src=/js/jquery.js></script>
<script src=/js/plugins.min.js></script>
<script src=/js/functions.js></script>
<script>jQuery(window).on("pluginCarouselReady",function(){$("#oc-features").owlCarousel({items:1,margin:60,nav:!0,navText:['<i class="icon-line-arrow-left"></i>','<i class="icon-line-arrow-right"></i>'],dots:!1,stagePadding:30,responsive:{768:{items:2},1200:{stagePadding:200}}})})</script></body></html>